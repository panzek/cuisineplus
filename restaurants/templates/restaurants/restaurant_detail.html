{% extends 'base.html' %}

{% load crispy_forms_tags %}
{% load cloudinary %}  

{% block content %}
{% if user.is_authenticated %}
<div class="masthead">
    <div class="container-fluid">
        <div class="row ">
            <div >
                {% if "placeholder" in restaurant.image.url %}
                <img src="https://codeinstitute.s3.amazonaws.com/fullstack/blog/default.jpg" width="100%">
                {% else %}
                <div class="row">
                  <div >
                    <img class="img-restaurant-detail" src="{{ restaurant.featured_image.url }}">
                    <span class="img-restaurant-detail-text"> {{ restaurant.name }}</span>
                  </div>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
<br>
<div class="container-fluid">
  <div class="row border-end">
    
    <!-- togglebar -->
    <div class="col-sm-12">
      <nav>
        <div class="nav nav-tabs" id="nav-tab" role="tablist">
          <button class="nav-link active" id="nav-home-tab" data-bs-toggle="tab" data-bs-target="#nav-home" type="button" role="tab" aria-controls="nav-home" aria-selected="true">Overview</button>
          <button class="nav-link" id="nav-profile-tab" data-bs-toggle="tab" data-bs-target="#nav-profile" type="button" role="tab" aria-controls="nav-profile" aria-selected="false">Reviews</button>
          <button class="nav-link" id="nav-contact-tab" data-bs-toggle="tab" data-bs-target="#nav-contact" type="button" role="tab" aria-controls="nav-contact" aria-selected="false">Menu</button>
        </div>
      </nav>
      <div class="tab-content" id="nav-tabContent">

        <!-- Overview tab -->
        <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">
          <div class="container-fluid border-end"><br>
            <div class="row ">
              <!-- Restaurant Overview -->
              <div class="col-6">
                <h5 class="card-title">{{ restaurant.name }}</h5>
                <p class="card-text"><i class="fa-solid fa-location-dot"></i> {{ restaurant.address }}</p>
                <p>
                  Lorem ipsum dolor sit amet consectetur adipisicing elit. Maxime mollitia,
                  molestiae quas vel sint commodi repudiandae consequuntur voluptatum laborum
                  numquam blanditiis harum quisquam eius sed odit fugiat iusto fuga praesentium
                  optio, eaque rerum! Provident similique accusantium nemo autem. Veritatis
                  obcaecati tenetur iure eius earum ut molestias architecto voluptate aliquam
                  nihil, eveniet aliquid culpa officia aut! Impedit sit sunt quaerat, odit,
                  tenetur error, harum nesciunt ipsum debitis quas aliquid. Reprehenderit,
                  quia. Quo neque error repudiandae fuga? Ipsa laudantium molestias eos 
                  sapiente officiis modi at sunt excepturi expedita sint? Sed quibusdam
                  recusandae alias error harum maxime adipisci amet laborum!
                </p>
                <div class="row">
                  <div class="col-6">
                    <div class="card-body">
                        <div class="reviews" style="padding: 10px;">
                          <h5><i class="fa-solid fa-circle-check"></i> Cuisines</h5>
                          <h5><i class="fa-solid fa-circle-check"></i> African</h5>
                          <h5><i class="fa-solid fa-circle-check"></i> Chinese</h5>
                          <h5><i class="fa-solid fa-circle-check"></i> Intercontinental</h5>  
                        </div><br>
                    </div>
                  </div>
                  <div class="col-6 ">
                    <p><i class="fa-regular fa-clock"></i> <strong>Open Hours:</strong> {{ restaurant.get_time_display }}</p>
                    <p><i class="fa-solid fa-phone"></i> <strong>Phone Numbers:</strong> {{ restaurant.phone }} </p>
                    <p><i class="fa-solid fa-location-dot"></i> <strong>Location:</strong> {{ restaurant.address }}</p>
                  </div>
              </div>
              </div>
              <!-- Booking form -->
              <div class="col-6">
                  <div class="card mx-auto" style="width: 25rem;">
                    <div class="card-body">
                        <div class="card-header text-center">
                            <h3 class="card-title">Make a Booking</h3>
                          </div><br>
                          <div class="text-center">
                            <form method="POST">
                              <input type="hidden" name="restaurant" value="{{ restaurant.pk }}">
                                {% csrf_token %}
                                {{ reservation_form.as_p }}
                                {{ crispy_forms | crispy }}
                                <div>
                                    <button type="submit" style="width: 22rem;" class="btn btn-primary">Confirm Reservation</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div> 
                </div>
            </div>
          </div>
        </div>

        <!-- Review tab -->
        <div class="tab-pane fade" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab">
          <div class="container-fluid ">
            <div class="row ">
              <div class="col-6">
                <div class="card-body">
                  <br>
                  <h5>Customer Reviews:</h5>
                  <p>Reviews can only be made by registered diners</p>
                  <hr>
                    {% for review in reviews %}
                    <div class="reviews" style="padding: 10px;">
                        <p class="font-weight-bold">
                            <span class=" text-muted font-weight-normal">
                              Wrote on: {{ review.created_on | date:"D, d M Y" }},
                              {{ review.created_on | time:"H:ia" }}
                            </span> 
                        </p>
                        "{{ review.body }}"" - {{ review.name }}
                        
                    </div><br><hr>
                    {% empty %}
                    <div>
                      <p>No customer reviews yet for this restaurant.</p>
                      <span>Be the first to write a review</span>
                    </div>
                    {% endfor %}
                </div>
              </div>
              <div class="col-6 border-end text-center ">
                {% if reviewed %}
                <div class="alert alert-success" role="alert">
                  {{ user.username }}, your review is awaiting approval
                </div>
                {% else %}
                {% if user.is_authenticated %}
                <br>

                <!-- Reviews form -->
                <div class="card mx-auto" style="width: 25rem;">
                  <div class="card-body">
                      <div class="card-header text-center">
                        <h3 class="card-title">Review this restaurant:</h3>
                        <p>Share your thoughts with other customers</p>
                        </div>
                        <div class="text-center">
                          <p>Reviewing as: {{ user.username }}</p>
                          <form method="POST">
                            <input type="hidden" name="restaurant" value="{{ restaurant.pk }}">
                              {% csrf_token %}
                              {{ review_form.as_p}}
                              {{ crispy_forms | crispy }}
                              <div>
                                  <button type="submit" style="width: 23rem;" class="btn btn-primary">Submit</button>
                              </div>
                          </form>
                      </div>
                  </div>
              </div>                  
                {% endif %}
                {% endif %}
              </div>
            </div>
          </div>
        </div>

        <!-- Menu tab -->
        {% for menu in menus %}
        <div class="tab-pane fade " id="nav-contact" role="tabpanel" aria-labelledby="nav-contact-tab">
          <div class="border-end">
            <!-- Bootstrap tab with vertical message  -->
            <div class="d-flex align-items-start">
              <div class="nav flex-column nav-pills me-3" id="v-pills-tab" role="tablist" aria-orientation="vertical">
                <button class="nav-link" id="v-pills-home-tab" data-bs-toggle="pill" data-bs-target="#v-pills-home" type="button" role="tab" aria-controls="v-pills-home" aria-selected="true">Food</button>
                <button class="nav-link" id="v-pills-profile-tab" data-bs-toggle="pill" data-bs-target="#v-pills-profile" type="button" role="tab" aria-controls="v-pills-profile" aria-selected="false">Drinks</button>
              </div>
              <div class="tab-content" id="v-pills-tabContent">
                <div class="tab-pane fade show active" id="v-pills-home" role="tabpanel" aria-labelledby="v-pills-home-tab">                  
                  <div class="accordion" id="accordionPanelsStayOpenExample">
                    <!-- First Accordion  -->
                    <div class="accordion-item">
                      <h2 class="accordion-header" id="panelsStayOpen-headingOne">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                          Menu Image
                        </button>
                      </h2>
                      <div id="panelsStayOpen-collapseOne" class="accordion-collapse collapse show" aria-labelledby="panelsStayOpen-headingOne">
                        <div class="accordion-body">
                          <div class="reviews" style="padding: 10px;">
                            <p class="font-weight-bold menu-image">
                            </p>
                        </div>
                        <div>{{ menu.body }}</div>
                        </div>
                      </div>
                    </div>
                     <!-- Second Accordion  -->
                    <div class="accordion-item">
                      <h2 class="accordion-header" id="panelsStayOpen-headingTwo">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseTwo" aria-expanded="false" aria-controls="panelsStayOpen-collapseTwo">
                          Menu Description
                        </button>
                      </h2>
                      <div id="panelsStayOpen-collapseTwo" class="accordion-collapse collapse" aria-labelledby="panelsStayOpen-headingTwo">
                        <div class="accordion-body">
                          <div><strong>Menu</strong></div> 
                          <div>Served Mon-Fri from <strong>{{ restaurant.get_time_display }}</strong></div>
                          {{ menu.description }}
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            {% endfor %}
          </div>
        </div>
      </div>
    </div>
    <script>
      $(function () {
        $("#id_date").datepicker({
          format:'dd/mm/yyyy',
        });
      });
    </script>
  </div>
</div>
{% endif %}
{% endblock %}